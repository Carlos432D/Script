-- Script GUI ForceField Completo - COM ANIMA√á√ïES
-- Cole este script em StarterGui como LocalScript

local Players = game:GetService("Players")
local UserInputService = game:GetService("UserInputService")
local RunService = game:GetService("RunService")
local TweenService = game:GetService("TweenService")

local player = Players.LocalPlayer
local playerGui = player:WaitForChild("PlayerGui")

-- Aguardar o personagem carregar
repeat wait() until player.Character

-- Criar ScreenGui
local screenGui = Instance.new("ScreenGui")
screenGui.Name = "ForceFieldGUI"
screenGui.ResetOnSpawn = false
screenGui.ZIndexBehavior = Enum.ZIndexBehavior.Sibling
screenGui.IgnoreGuiInset = true
screenGui.Parent = playerGui

-- Frame Principal (GUI Azul)
local mainFrame = Instance.new("Frame")
mainFrame.Name = "MainFrame"
mainFrame.Size = UDim2.new(0, 250, 0, 150)
mainFrame.Position = UDim2.new(0.5, -125, 0.5, -75)
mainFrame.BackgroundColor3 = Color3.fromRGB(30, 144, 255)
mainFrame.BorderSizePixel = 0
mainFrame.Active = true
mainFrame.Draggable = false
mainFrame.ClipsDescendants = false
mainFrame.Parent = screenGui

-- Arredondar cantos
local corner = Instance.new("UICorner")
corner.CornerRadius = UDim.new(0, 12)
corner.Parent = mainFrame

-- Sombra/Borda animada
local border = Instance.new("UIStroke")
border.Color = Color3.fromRGB(0, 80, 180)
border.Thickness = 3
border.Transparency = 0
border.Parent = mainFrame

-- Gradiente de fundo animado
local gradient = Instance.new("UIGradient")
gradient.Color = ColorSequence.new{
    ColorSequenceKeypoint.new(0, Color3.fromRGB(30, 144, 255)),
    ColorSequenceKeypoint.new(1, Color3.fromRGB(0, 100, 200))
}
gradient.Rotation = 45
gradient.Parent = mainFrame

-- T√≠tulo
local title = Instance.new("TextLabel")
title.Name = "Title"
title.Size = UDim2.new(1, 0, 0, 40)
title.Position = UDim2.new(0, 0, 0, 0)
title.BackgroundTransparency = 1
title.Text = "‚ö° ForceField System ‚ö°"
title.TextColor3 = Color3.fromRGB(255, 255, 255)
title.TextSize = 18
title.Font = Enum.Font.GothamBold
title.TextStrokeTransparency = 0.5
title.Parent = mainFrame

-- Bot√£o FF (ON/OFF)
local ffButton = Instance.new("TextButton")
ffButton.Name = "FFButton"
ffButton.Size = UDim2.new(0, 200, 0, 50)
ffButton.Position = UDim2.new(0.5, -100, 0, 60)
ffButton.BackgroundColor3 = Color3.fromRGB(220, 53, 69)
ffButton.BorderSizePixel = 0
ffButton.Text = "üõ°Ô∏è FF: OFF"
ffButton.TextColor3 = Color3.fromRGB(255, 255, 255)
ffButton.TextSize = 20
ffButton.Font = Enum.Font.GothamBold
ffButton.AutoButtonColor = false
ffButton.Parent = mainFrame

local buttonCorner = Instance.new("UICorner")
buttonCorner.CornerRadius = UDim.new(0, 8)
buttonCorner.Parent = ffButton

local buttonStroke = Instance.new("UIStroke")
buttonStroke.Color = Color3.fromRGB(255, 255, 255)
buttonStroke.Thickness = 2
buttonStroke.Transparency = 0.7
buttonStroke.Parent = ffButton

-- Part√≠culas de brilho (decora√ß√£o)
local particleFrame = Instance.new("Frame")
particleFrame.Name = "Particles"
particleFrame.Size = UDim2.new(1, 0, 1, 0)
particleFrame.Position = UDim2.new(0, 0, 0, 0)
particleFrame.BackgroundTransparency = 1
particleFrame.ClipsDescendants = true
particleFrame.ZIndex = 0
particleFrame.Parent = mainFrame

-- Vari√°veis de Estado
local ffEnabled = false
local forceFieldEffect = nil
local healthConnection = nil
local damageConnection = nil
local descendantConnection = nil

-- Anima√ß√µes
local tweenInfo = TweenInfo.new(0.3, Enum.EasingStyle.Quad, Enum.EasingDirection.Out)
local tweenInfoFast = TweenInfo.new(0.15, Enum.EasingStyle.Back, Enum.EasingDirection.Out)
local tweenInfoBounce = TweenInfo.new(0.5, Enum.EasingStyle.Elastic, Enum.EasingDirection.Out)

-- Anima√ß√£o de entrada da GUI
mainFrame.Size = UDim2.new(0, 0, 0, 0)
mainFrame.Rotation = 180
local openTween = TweenService:Create(mainFrame, TweenInfo.new(0.6, Enum.EasingStyle.Back, Enum.EasingDirection.Out), {
    Size = UDim2.new(0, 250, 0, 150),
    Rotation = 0
})
openTween:Play()

-- Anima√ß√£o de pulso no t√≠tulo
spawn(function()
    while wait(2) do
        if title and title.Parent then
            local pulseTween = TweenService:Create(title, TweenInfo.new(0.5, Enum.EasingStyle.Sine, Enum.EasingDirection.InOut), {
                TextSize = 20
            })
            pulseTween:Play()
            pulseTween.Completed:Wait()
            
            local pulseTween2 = TweenService:Create(title, TweenInfo.new(0.5, Enum.EasingStyle.Sine, Enum.EasingDirection.InOut), {
                TextSize = 18
            })
            pulseTween2:Play()
        else
            break
        end
    end
end)

-- Anima√ß√£o de rota√ß√£o do gradiente
spawn(function()
    while wait(0.05) do
        if gradient and gradient.Parent then
            gradient.Rotation = (gradient.Rotation + 1) % 360
        else
            break
        end
    end
end)

-- Anima√ß√£o de brilho na borda quando FF est√° ativo
local borderAnimRunning = false
local function animateBorder()
    if borderAnimRunning then return end
    borderAnimRunning = true
    
    spawn(function()
        while ffEnabled and border and border.Parent do
            local glowTween = TweenService:Create(border, TweenInfo.new(0.8, Enum.EasingStyle.Sine, Enum.EasingDirection.InOut), {
                Thickness = 5,
                Color = Color3.fromRGB(100, 255, 100)
            })
            glowTween:Play()
            glowTween.Completed:Wait()
            
            if not ffEnabled then break end
            
            local glowTween2 = TweenService:Create(border, TweenInfo.new(0.8, Enum.EasingStyle.Sine, Enum.EasingDirection.InOut), {
                Thickness = 3,
                Color = Color3.fromRGB(0, 200, 100)
            })
            glowTween2:Play()
            glowTween2.Completed:Wait()
        end
        
        -- Resetar borda
        if border and border.Parent then
            TweenService:Create(border, tweenInfo, {
                Thickness = 3,
                Color = Color3.fromRGB(0, 80, 180)
            }):Play()
        end
        
        borderAnimRunning = false
    end)
end

-- Sistema de Arrastar Melhorado
local dragging = false
local dragInput
local dragStart
local startPos

local function updateDrag(input)
    if not dragging then return end
    local delta = input.Position - dragStart
    local newPos = UDim2.new(
        startPos.X.Scale,
        startPos.X.Offset + delta.X,
        startPos.Y.Scale,
        startPos.Y.Offset + delta.Y
    )
    mainFrame.Position = newPos
end

mainFrame.InputBegan:Connect(function(input)
    if input.UserInputType == Enum.UserInputType.MouseButton1 or 
       input.UserInputType == Enum.UserInputType.Touch then
        dragging = true
        dragStart = input.Position
        startPos = mainFrame.Position
        
        -- Anima√ß√£o ao pegar
        TweenService:Create(mainFrame, tweenInfoFast, {
            Size = UDim2.new(0, 245, 0, 145)
        }):Play()
        
        local connection
        connection = input.Changed:Connect(function()
            if input.UserInputState == Enum.UserInputState.End then
                dragging = false
                
                -- Anima√ß√£o ao soltar
                TweenService:Create(mainFrame, tweenInfoBounce, {
                    Size = UDim2.new(0, 250, 0, 150)
                }):Play()
                
                if connection then
                    connection:Disconnect()
                end
            end
        end)
    end
end)

mainFrame.InputChanged:Connect(function(input)
    if input.UserInputType == Enum.UserInputType.MouseMovement or 
       input.UserInputType == Enum.UserInputType.Touch then
        dragInput = input
    end
end)

UserInputService.InputChanged:Connect(function(input)
    if input == dragInput then
        updateDrag(input)
    end
end)

-- Efeito hover no bot√£o
ffButton.MouseEnter:Connect(function()
    TweenService:Create(ffButton, tweenInfoFast, {
        Size = UDim2.new(0, 210, 0, 55)
    }):Play()
    
    TweenService:Create(buttonStroke, tweenInfoFast, {
        Transparency = 0.3
    }):Play()
end)

ffButton.MouseLeave:Connect(function()
    TweenService:Create(ffButton, tweenInfoFast, {
        Size = UDim2.new(0, 200, 0, 50)
    }):Play()
    
    TweenService:Create(buttonStroke, tweenInfoFast, {
        Transparency = 0.7
    }):Play()
end)

-- Fun√ß√£o para limpar conex√µes
local function cleanupConnections()
    if healthConnection then
        healthConnection:Disconnect()
        healthConnection = nil
    end
    
    if damageConnection then
        damageConnection:Disconnect()
        damageConnection = nil
    end
    
    if descendantConnection then
        descendantConnection:Disconnect()
        descendantConnection = nil
    end
end

-- Fun√ß√£o para criar part√≠culas de ativa√ß√£o
local function createActivationParticles()
    for i = 1, 10 do
        local particle = Instance.new("Frame")
        particle.Size = UDim2.new(0, 8, 0, 8)
        particle.Position = UDim2.new(0.5, -4, 0.5, -4)
        particle.BackgroundColor3 = Color3.fromRGB(100, 255, 100)
        particle.BorderSizePixel = 0
        particle.Parent = particleFrame
        
        local particleCorner = Instance.new("UICorner")
        particleCorner.CornerRadius = UDim.new(1, 0)
        particleCorner.Parent = particle
        
        local angle = math.rad(i * 36)
        local distance = 150
        local endX = 0.5 + math.cos(angle) * distance / 250
        local endY = 0.5 + math.sin(angle) * distance / 150
        
        local particleTween = TweenService:Create(particle, TweenInfo.new(0.8, Enum.EasingStyle.Quad, Enum.EasingDirection.Out), {
            Position = UDim2.new(endX, -4, endY, -4),
            Size = UDim2.new(0, 0, 0, 0),
            BackgroundTransparency = 1
        })
        
        particleTween:Play()
        particleTween.Completed:Connect(function()
            particle:Destroy()
        end)
    end
end

-- Fun√ß√£o para ativar ForceField
local function enableForceField()
    local character = player.Character
    if not character then return end
    
    local humanoid = character:FindFirstChildOfClass("Humanoid")
    local humanoidRootPart = character:FindFirstChild("HumanoidRootPart")
    
    if not humanoid or not humanoidRootPart then return end
    
    -- Limpar ForceField antigo se existir
    local oldFF = character:FindFirstChild("CustomForceField")
    if oldFF then
        oldFF:Destroy()
    end
    
    -- Criar efeito visual de ForceField (VIS√çVEL PARA TODOS)
    forceFieldEffect = Instance.new("ForceField")
    forceFieldEffect.Name = "CustomForceField"
    forceFieldEffect.Visible = true
    forceFieldEffect.Parent = character
    
    -- Limpar conex√µes antigas
    cleanupConnections()
    
    -- Prote√ß√£o de vida infinita
    healthConnection = humanoid.HealthChanged:Connect(function(health)
        if ffEnabled and health < humanoid.MaxHealth then
            humanoid.Health = humanoid.MaxHealth
        end
    end)
    
    -- Definir sa√∫de m√°xima imediatamente
    humanoid.Health = humanoid.MaxHealth
    
    -- Prote√ß√£o cont√≠nua contra qualquer dano
    damageConnection = RunService.Heartbeat:Connect(function()
        if not ffEnabled then return end
        
        local char = player.Character
        if not char then return end
        
        local hum = char:FindFirstChildOfClass("Humanoid")
        if hum then
            if hum.Health < hum.MaxHealth then
                hum.Health = hum.MaxHealth
            end
            
            if hum:GetState() == Enum.HumanoidStateType.Dead then
                hum:ChangeState(Enum.HumanoidStateType.GettingUp)
            end
        end
    end)
    
    -- Prote√ß√£o contra novos objetos que causam dano
    descendantConnection = character.DescendantAdded:Connect(function(descendant)
        if not ffEnabled then return end
        
        if descendant:IsA("Fire") or descendant:IsA("Smoke") then
            task.wait(0.1)
            if ffEnabled then
                descendant:Destroy()
            end
        end
    end)
    
    -- Remover objetos de dano existentes
    for _, descendant in pairs(character:GetDescendants()) do
        if descendant:IsA("Fire") or descendant:IsA("Smoke") then
            descendant:Destroy()
        end
    end
end

-- Fun√ß√£o para desativar ForceField
local function disableForceField()
    cleanupConnections()
    
    if forceFieldEffect and forceFieldEffect.Parent then
        forceFieldEffect:Destroy()
        forceFieldEffect = nil
    end
    
    local character = player.Character
    if character then
        local oldFF = character:FindFirstChild("CustomForceField")
        if oldFF then
            oldFF:Destroy()
        end
    end
end

-- Evento do Bot√£o com anima√ß√µes
local debounce = false
ffButton.MouseButton1Click:Connect(function()
    if debounce then return end
    debounce = true
    
    -- Anima√ß√£o de clique
    local clickTween = TweenService:Create(ffButton, TweenInfo.new(0.1, Enum.EasingStyle.Quad, Enum.EasingDirection.Out), {
        Size = UDim2.new(0, 180, 0, 40)
    })
    clickTween:Play()
    clickTween.Completed:Wait()
    
    ffEnabled = not ffEnabled
    
    if ffEnabled then
        -- Ativar FF com anima√ß√£o verde
        local colorTween = TweenService:Create(ffButton, tweenInfo, {
            BackgroundColor3 = Color3.fromRGB(40, 167, 69)
        })
        colorTween:Play()
        
        ffButton.Text = "üõ°Ô∏è FF: ON"
        
        -- Part√≠culas de ativa√ß√£o
        createActivationParticles()
        
        -- Animar GUI para verde
        TweenService:Create(mainFrame, tweenInfo, {
            BackgroundColor3 = Color3.fromRGB(40, 200, 100)
        }):Play()
        
        TweenService:Create(gradient, tweenInfo, {
            Rotation = 90
        }):Play()
        
        enableForceField()
        animateBorder()
        
    else
        -- Desativar FF com anima√ß√£o vermelha
        local colorTween = TweenService:Create(ffButton, tweenInfo, {
            BackgroundColor3 = Color3.fromRGB(220, 53, 69)
        })
        colorTween:Play()
        
        ffButton.Text = "üõ°Ô∏è FF: OFF"
        
        -- Animar GUI para azul
        TweenService:Create(mainFrame, tweenInfo, {
            BackgroundColor3 = Color3.fromRGB(30, 144, 255)
        }):Play()
        
        TweenService:Create(gradient, tweenInfo, {
            Rotation = 45
        }):Play()
        
        disableForceField()
    end
    
    -- Voltar ao tamanho normal
    TweenService:Create(ffButton, tweenInfoBounce, {
        Size = UDim2.new(0, 200, 0, 50)
    }):Play()
    
    wait(0.3)
    debounce = false
end)

-- Reativar ForceField quando respawnar
player.CharacterAdded:Connect(function(character)
    local humanoid = character:WaitForChild("Humanoid", 5)
    local humanoidRootPart = character:WaitForChild("HumanoidRootPart", 5)
    
    if humanoid and humanoidRootPart then
        wait(0.5)
        
        if ffEnabled then
            enableForceField()
        end
    end
end)

-- Ativar inicialmente se necess√°rio
if player.Character and ffEnabled then
    enableForceField()
end

-- Limpeza ao remover GUI
screenGui.Destroying:Connect(function()
    cleanupConnections()
    if forceFieldEffect then
        forceFieldEffect:Destroy()
    end
end)

print("‚úÖ ForceField GUI com ANIMA√á√ïES carregado com sucesso!")
