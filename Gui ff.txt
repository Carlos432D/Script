--[[
üîπ ForceField GUI Script (√önico) ‚Äî by ChatGPT
Coloque este script em ServerScriptService

Fun√ß√µes:
‚úÖ Cria GUI azul arrast√°vel com bot√£o ON/OFF
‚úÖ Bot√£o ativa/desativa ForceField (vis√≠vel a todos)
‚úÖ Jogador com FF tem vida "infinita" e n√£o causa dano
‚úÖ Estado sincronizado (bot√£o mostra corretamente ON/OFF)
‚úÖ Sem erros, sem depend√™ncias externas
--]]

local Players = game:GetService("Players")
local ServerStorage = game:GetService("ServerStorage")

-- RemoteEvents
local remoteToggle = Instance.new("RemoteEvent")
remoteToggle.Name = "FF_Toggle"
remoteToggle.Parent = script

local remoteStatus = Instance.new("RemoteEvent")
remoteStatus.Name = "FF_Status"
remoteStatus.Parent = script

-- Pasta para guardar ferramentas
local toolStorage = ServerStorage:FindFirstChild("FF_Tools") or Instance.new("Folder")
toolStorage.Name = "FF_Tools"
toolStorage.Parent = ServerStorage

-- Estado dos jogadores
local ffActive = {}

-- === Fun√ß√µes auxiliares ===
local function storeTools(player)
	local id = tostring(player.UserId)
	local folder = toolStorage:FindFirstChild(id) or Instance.new("Folder")
	folder.Name = id
	folder.Parent = toolStorage

	local function moveTools(container)
		for _, item in ipairs(container:GetChildren()) do
			if item:IsA("Tool") then
				item.Parent = folder
			end
		end
	end

	local backpack = player:FindFirstChildOfClass("Backpack")
	if backpack then moveTools(backpack) end
	local char = player.Character
	if char then moveTools(char) end
end

local function restoreTools(player)
	local id = tostring(player.UserId)
	local folder = toolStorage:FindFirstChild(id)
	if not folder then return end
	local backpack = player:FindFirstChildOfClass("Backpack")
	if not backpack then return end
	for _, item in ipairs(folder:GetChildren()) do
		item.Parent = backpack
	end
	folder:Destroy()
end

local function applyFF(player)
	local char = player.Character
	if not char then return end
	local hum = char:FindFirstChildOfClass("Humanoid")
	if not hum then return end

	-- Cria ForceField se n√£o existir
	if not char:FindFirstChildOfClass("ForceField") then
		local ff = Instance.new("ForceField")
		ff.Name = "ActiveForceField"
		ff.Parent = char
	end

	storeTools(player)
	ffActive[player] = true

	-- Vida infinita (muito alta)
	hum.MaxHealth = 1e7
	hum.Health = hum.MaxHealth

	-- Mant√©m a vida no m√°ximo
	hum.HealthChanged:Connect(function()
		if ffActive[player] and hum.Health < hum.MaxHealth then
			hum.Health = hum.MaxHealth
		end
	end)
end

local function removeFF(player)
	local char = player.Character
	if not char then return end
	local hum = char:FindFirstChildOfClass("Humanoid")
	if not hum then return end

	local ff = char:FindFirstChildOfClass("ForceField")
	if ff then ff:Destroy() end

	restoreTools(player)
	ffActive[player] = false
	hum.MaxHealth = 100
	if hum.Health > hum.MaxHealth then hum.Health = hum.MaxHealth end
end

-- Alternar FF
remoteToggle.OnServerEvent:Connect(function(player)
	if not player or not player.Parent then return end
	if ffActive[player] then
		removeFF(player)
	else
		applyFF(player)
	end
	remoteStatus:FireClient(player, ffActive[player])
end)

-- Reaplicar ao respawn
Players.PlayerAdded:Connect(function(player)
	ffActive[player] = false

	player.CharacterAdded:Connect(function(char)
		task.wait(0.5)
		if ffActive[player] then
			applyFF(player)
		end
	end)

	-- Injetar GUI no jogador
	local guiScript = Instance.new("LocalScript")
	guiScript.Name = "FF_LocalGui"
	guiScript.Source = [[
local player = game.Players.LocalPlayer
local remoteToggle = script:WaitForChild("FF_Toggle")
local remoteStatus = script:WaitForChild("FF_Status")

-- Cria GUI
local gui = Instance.new("ScreenGui")
gui.Name = "FF_Gui"
gui.ResetOnSpawn = true
gui.Parent = player:WaitForChild("PlayerGui")

local frame = Instance.new("Frame")
frame.Size = UDim2.new(0,220,0,90)
frame.Position = UDim2.new(0.05,0,0.05,0)
frame.BackgroundColor3 = Color3.fromRGB(0,100,255)
frame.Active = true
frame.Draggable = true
frame.Parent = gui

local title = Instance.new("TextLabel")
title.Size = UDim2.new(1,0,0,25)
title.BackgroundTransparency = 1
title.Text = "‚ö° ForceField Mode"
title.TextColor3 = Color3.new(1,1,1)
title.Font = Enum.Font.SourceSansBold
title.TextSize = 18
title.Parent = frame

local button = Instance.new("TextButton")
button.Size = UDim2.new(0,120,0,40)
button.Position = UDim2.new(0.5,-60,0.5,-10)
button.Text = "Ativar FF"
button.TextColor3 = Color3.new(1,1,1)
button.BackgroundColor3 = Color3.fromRGB(0,70,200)
button.Font = Enum.Font.SourceSansBold
button.TextSize = 18
button.Parent = frame

local status = Instance.new("TextLabel")
status.Size = UDim2.new(1,0,0,20)
status.Position = UDim2.new(0,0,1,-20)
status.BackgroundTransparency = 1
status.Text = "Status: Inativo"
status.TextColor3 = Color3.new(1,1,1)
status.Font = Enum.Font.SourceSans
status.TextSize = 14
status.Parent = frame

local isOn = false
button.MouseButton1Click:Connect(function()
	remoteToggle:FireServer()
end)

remoteStatus.OnClientEvent:Connect(function(state)
	isOn = state
	if isOn then
		button.Text = "Desativar FF"
		button.BackgroundColor3 = Color3.fromRGB(0,180,100)
		status.Text = "Status: Ativo"
	else
		button.Text = "Ativar FF"
		button.BackgroundColor3 = Color3.fromRGB(0,70,200)
		status.Text = "Status: Inativo"
	end
end)
]]

	-- Adiciona eventos para o LocalScript
	local t1 = remoteToggle:Clone()
	t1.Parent = guiScript
	local t2 = remoteStatus:Clone()
	t2.Parent = guiScript

	guiScript.Parent = player:WaitForChild("PlayerGui")
end)
